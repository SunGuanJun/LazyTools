package Test;

import java.math.BigDecimal;
import java.math.RoundingMode;
import java.util.Calendar;

/**
 * Created by hzsunguanjun on 2017/5/17.
 */
public class App {
    //        update TB_YX_PMS_FIN_PURCHASE_SCHEDULE set planQuantity=? where paymentNum=? and skuId=?;
    //        update TB_YX_PMS_FIN_PAYMENT_DETAIL set totalMoney=?, theoryApplyMoney=?, actualApplyMoney=? where paymentNum=?;

    public static void main(String[] args){
        Calendar calendar = Calendar.getInstance();
        int date = calendar.get(Calendar.DATE);     //当前日期
        Long currentTime = calendar.getTimeInMillis();

        //得到上月月初
        calendar.set(Calendar.MONTH, 5);
        calendar.set(Calendar.DAY_OF_MONTH,calendar.getActualMinimum(Calendar.DAY_OF_MONTH));
        calendar.set(Calendar.HOUR_OF_DAY, 0);
        calendar.set(Calendar.MINUTE, 0);
        calendar.set(Calendar.SECOND, 0);
        calendar.set(Calendar.MILLISECOND, 000);
        Long beginTime = calendar.getTime().getTime();

        //得到上月月末
        calendar.set(Calendar.DAY_OF_MONTH,calendar.getActualMaximum(Calendar.DAY_OF_MONTH));
        calendar.set(Calendar.HOUR_OF_DAY, 23);
        calendar.set(Calendar.MINUTE, 59);
        calendar.set(Calendar.SECOND, 59);
        calendar.set(Calendar.MILLISECOND, 999);
        Long endTime = calendar.getTime().getTime();

        System.out.println(beginTime);
        System.out.println(endTime);



//        App app = new App();
////        app.poSch();
////        app.detail();
//
//        List<String> list = new ArrayList<>();
//        Iterator iterator = list.iterator();
//        if (iterator.hasNext()){
//            iterator.next();
//        }
    }

    public void detail(){
        String str = "| PMSP-YC16060123-1 |             30 |         3250000.00 |\n" +
                "| PMSP-YC16120754-1 |             30 |        26861793.60 |\n" +
                "| PMSP-YC17020084-1 |             10 |           43400.00 |\n" +
                "| PMSP-YC17030148-1 |             30 |         2608000.00 |\n" +
                "| PMSP-YC17030185-1 |             30 |          842045.00 |\n" +
                "| PMSP-YC17030210-1 |             30 |          356330.00 |\n" +
                "| PMSP-YC17030279-1 |             30 |         6590719.20 |\n" +
                "| PMSP-YC17030279-2 |             30 |         6202694.40 |\n" +
                "| PMSP-YC17030286-1 |             30 |         2447000.00 |\n" +
                "| PMSP-YC17030294-1 |             30 |         4989335.00 |\n" +
                "| PMSP-YC17040341-1 |             30 |         3336660.00 |\n" +
                "| PMSP-YC17040424-1 |             30 |           37500.00 |\n" +
                "| PMSP-YC17050504-1 |             30 |          498888.80 |\n";
        //pay，比例，总金额

        String[] lines = str.split("\\n");
        String update1;
        for (int i=0; i<lines.length; i++){
            String[] strArray = lines[i].split("\\|");
            String paymentNum = strArray[1].trim();
            String rate = strArray[2].trim();
            BigDecimal price = new BigDecimal(strArray[3].trim());

            BigDecimal rateBD = new BigDecimal(rate).divide(new BigDecimal(100));
            BigDecimal apply = price.multiply(rateBD).setScale(2, RoundingMode.HALF_EVEN);

            update1 = "update TB_YX_PMS_FIN_PAYMENT_DETAIL set totalMoney=" + price + ", theoryApplyMoney=" +
                    apply + ", actualApplyMoney=" + apply + " where paymentNum='" + paymentNum + "';";
            System.out.println(update1);
        }
    }

    public void poSch(){
        String str = "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189037 |                20000 |          260000.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189038 |                15000 |          195000.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189039 |                15000 |          195000.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189043 |                30000 |          390000.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189044 |                22500 |          292500.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189045 |                22500 |          292500.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189046 |                12500 |          162500.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189047 |                16700 |          217100.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189048 |                12500 |          162500.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189052 |                15600 |          202800.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189053 |                20800 |          270400.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189054 |                15600 |          202800.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189058 |                 9400 |          122200.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189059 |                12500 |          162500.00 |\n" +
                "| PMSP-YC16060123-1 | YC16060123-20170516-1 | 1189060 |                 9400 |          122200.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1175063 |                30592 |          731148.80 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1175064 |                59408 |         1419851.20 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1175065 |                20400 |          487560.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1175066 |                39616 |          946822.40 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1175067 |                59408 |         1479259.20 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1175068 |                30592 |          807628.80 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1175069 |                39616 |          986438.40 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1175070 |                20400 |          538560.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176103 |                30592 |          740326.40 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176104 |                59408 |         1437673.60 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176105 |                20400 |          493680.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176106 |                39616 |          958707.20 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176107 |                59408 |         1491140.80 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176108 |                30592 |          807628.80 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176109 |                39616 |          994361.60 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176110 |                20400 |          538560.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176130 |                20400 |          497760.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176131 |                39616 |          966630.40 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176132 |                13616 |          332230.40 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176133 |                26400 |          644160.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176134 |                39616 |          994361.60 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176135 |                20400 |          544680.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176136 |                26400 |          662640.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176137 |                13616 |          363547.20 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176147 |                30592 |          694438.40 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176148 |                59408 |         1348561.60 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176149 |                20400 |          463080.00 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176150 |                39616 |          899283.20 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176151 |                59408 |         1407969.60 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176152 |                30592 |          746444.80 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176153 |                39616 |          938899.20 |\n" +
                "| PMSP-YC16120754-1 | YC16120754-20170505-1 | 1176154 |                20400 |          497760.00 |\n" +
                "| PMSP-YC17020084-1 | YC17020084-20170515-1 | 1137059 |                 7000 |           22400.00 |\n" +
                "| PMSP-YC17020084-1 | YC17020084-20170515-1 | 1137063 |                 5000 |           21000.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176227 |                 1450 |          236350.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176228 |                 1440 |          234720.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176229 |                 2140 |          348820.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176230 |                 2130 |          347190.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176231 |                 2360 |          384680.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176232 |                 2370 |          386310.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176233 |                 1360 |          221680.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176234 |                 1380 |          224940.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176235 |                  690 |          112470.00 |\n" +
                "| PMSP-YC17030148-1 | YC17030148-20170515-1 | 1176236 |                  680 |          110840.00 |\n" +
                "| PMSP-YC17030185-1 | YC17030185-20170503-1 | 1044057 |                 2000 |          450000.00 |\n" +
                "| PMSP-YC17030185-1 | YC17030185-20170503-1 | 1044070 |                 3000 |           72540.00 |\n" +
                "| PMSP-YC17030185-1 | YC17030185-20170503-1 | 1044071 |                 1500 |           45360.00 |\n" +
                "| PMSP-YC17030185-1 | YC17030185-20170503-1 | 1044072 |                 2000 |           68540.00 |\n" +
                "| PMSP-YC17030185-1 | YC17030185-20170503-1 | 1044073 |                 1500 |           53460.00 |\n" +
                "| PMSP-YC17030185-1 | YC17030185-20170503-1 | 1044074 |                 1500 |           61290.00 |\n" +
                "| PMSP-YC17030185-1 | YC17030185-20170503-1 | 1044075 |                 1500 |           40485.00 |\n" +
                "| PMSP-YC17030185-1 | YC17030185-20170503-1 | 1044076 |                 1500 |           50370.00 |\n" +
                "| PMSP-YC17030210-1 | YC17030210-20170428-1 | 1176302 |                 5000 |          356330.00 |\n" +
                "| PMSP-YC17030279-1 | YC17030279-20170424-1 | 1147021 |                10002 |         1130226.00 |\n" +
                "| PMSP-YC17030279-1 | YC17030279-20170424-1 | 1147022 |                10002 |         1130226.00 |\n" +
                "| PMSP-YC17030279-1 | YC17030279-20170424-1 | 1147023 |                39984 |         4330267.20 |\n" +
                "| PMSP-YC17030279-2 | YC17030279-20170424-2 | 1147021 |                10002 |          980196.00 |\n" +
                "| PMSP-YC17030279-2 | YC17030279-20170424-2 | 1147022 |                10002 |          980196.00 |\n" +
                "| PMSP-YC17030279-2 | YC17030279-20170424-2 | 1147023 |                39984 |         4242302.40 |\n" +
                "| PMSP-YC17030286-1 | YC17030286-20170516-1 | 1171085 |                 5000 |           52500.00 |\n" +
                "| PMSP-YC17030286-1 | YC17030286-20170516-1 | 1171086 |                 5000 |           52500.00 |\n" +
                "| PMSP-YC17030286-1 | YC17030286-20170516-1 | 1171087 |                 5000 |           62250.00 |\n" +
                "| PMSP-YC17030286-1 | YC17030286-20170516-1 | 1171088 |                 5000 |           62250.00 |\n" +
                "| PMSP-YC17030286-1 | YC17030286-20170516-1 | 1172041 |                 5000 |          675000.00 |\n" +
                "| PMSP-YC17030286-1 | YC17030286-20170516-1 | 1172042 |                 5000 |          675000.00 |\n" +
                "| PMSP-YC17030286-1 | YC17030286-20170516-1 | 1172068 |                10000 |           86000.00 |\n" +
                "| PMSP-YC17030286-1 | YC17030286-20170516-1 | 1172069 |                10000 |          106500.00 |\n" +
                "| PMSP-YC17030286-1 | YC17030286-20170516-1 | 1210021 |                 5000 |          675000.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128027 |                 1040 |           27040.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128028 |                 3180 |           82680.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128029 |                 3960 |          102960.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128030 |                 3840 |           99840.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128031 |                 2760 |           71760.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128032 |                 1450 |           37700.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128033 |                 4200 |          109200.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128034 |                 5040 |          131040.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128035 |                 4080 |          106080.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128036 |                 1920 |           49920.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128037 |                 1650 |           42900.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128038 |                 3540 |           92040.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128039 |                 5100 |          132600.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128040 |                 3900 |          101400.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1128041 |                 3040 |           79040.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129000 |                  900 |           58500.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129001 |                 1540 |          100100.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129002 |                 2310 |          150150.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129003 |                  770 |           50050.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129004 |                  500 |           32500.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129005 |                  525 |           34125.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129006 |                 1540 |          100100.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129007 |                 1540 |          100100.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129008 |                 1540 |          100100.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129009 |                 1000 |           65000.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129010 |                  525 |           34125.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129011 |                 1540 |          100100.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129012 |                 2800 |          182000.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129013 |                 2310 |          150150.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129014 |                 1350 |           87750.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129015 |                  525 |           34125.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129016 |                 2310 |          150150.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129017 |                 2800 |          182000.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129018 |                 2940 |          191100.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1129019 |                 1750 |          113750.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130103 |                  640 |           33280.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130104 |                 2560 |          133120.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130105 |                 3200 |          166400.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130106 |                 2040 |          106080.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130107 |                 1800 |           93600.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130109 |                 3280 |          170560.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130110 |                 3040 |          158080.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130111 |                 3120 |          162240.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130112 |                 1640 |           85280.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130113 |                  560 |           29120.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130114 |                 2730 |          141960.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130115 |                 4770 |          248040.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130116 |                 2250 |          117000.00 |\n" +
                "| PMSP-YC17030294-1 | YC17030294-20170512-2 | 1130117 |                 1200 |           62400.00 |\n" +
                "| PMSP-YC17040341-1 | YC17040341-20170427-1 | 1165547 |                15000 |          344250.00 |\n" +
                "| PMSP-YC17040341-1 | YC17040341-20170427-1 | 1165548 |                15000 |          344250.00 |\n" +
                "| PMSP-YC17040341-1 | YC17040341-20170427-1 | 1165551 |                24000 |          483840.00 |\n" +
                "| PMSP-YC17040341-1 | YC17040341-20170427-1 | 1165552 |                24000 |          483840.00 |\n" +
                "| PMSP-YC17040341-1 | YC17040341-20170427-1 | 1165553 |                24000 |          483840.00 |\n" +
                "| PMSP-YC17040341-1 | YC17040341-20170427-1 | 1165554 |                24000 |          483840.00 |\n" +
                "| PMSP-YC17040341-1 | YC17040341-20170427-1 | 1165558 |                15000 |          356400.00 |\n" +
                "| PMSP-YC17040341-1 | YC17040341-20170427-1 | 1165559 |                15000 |          356400.00 |\n" +
                "| PMSP-YC17040424-1 | YC17040424-20170517-1 | 1179001 |                 5000 |           37500.00 |\n" +
                "| PMSP-YC17050504-1 | YC17050504-20170510-1 | 1006130 |                 5016 |          121888.80 |\n" +
                "| PMSP-YC17050504-1 | YC17050504-20170510-1 | 1022057 |                 3000 |           87000.00 |\n" +
                "| PMSP-YC17050504-1 | YC17050504-20170510-1 | 1022058 |                 5000 |          145000.00 |\n" +
                "| PMSP-YC17050504-1 | YC17050504-20170510-1 | 1023008 |                 5000 |          145000.00 |";

        String[] lines = str.split("\\n");
        String update1;
        for (int i=0; i<lines.length; i++){
            String[] strArray = lines[i].split("\\|");
            String paymentNum = strArray[1].trim();
            String purchaseOrder = strArray[2].trim();
            String skuId = strArray[3].trim();
            String count = strArray[4].trim();
            String price = strArray[5].trim();

            update1 = "update TB_YX_PMS_FIN_PURCHASE_SCHEDULE set planQuantity=" + count + " where paymentNum='" +
                    paymentNum + "'and skuId=" + skuId +";";
            System.out.println(update1);
        }
    }
}
